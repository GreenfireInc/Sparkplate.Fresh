# Litecoin QR Code Pill Switcher Implementation
**Date:** September 26, 2025
**Author:** System Assistant
**Task:** Implement pill switcher for Litecoin multi-format address display

## Overview
This report documents the implementation of pill switcher functionality for Litecoin addresses, extending the multi-format address support to include P2PKH (Legacy), P2SH (SegWit Compatible), and P2WPKH (Native SegWit) address formats, following the same pattern established for Polkadot.

## Problem Statement
Litecoin supports multiple address formats that provide different benefits:
- **P2PKH (Legacy)**: Original format, starts with 'L', most compatible
- **P2SH (SegWit Compatible)**: SegWit wrapped in P2SH, starts with 'M', better fees
- **P2WPKH (Native SegWit)**: Modern format, starts with 'ltc1', best fees and features

Previously, users could only generate one address format at a time. The implementation adds the ability to switch between all three formats using a pill switcher, similar to Polkadot's network switching.

## Solution Implemented

### 1. Enhanced Litecoin Router Multi-Format Support
**Location:** `src/components/currencies/LTC.Litecoin.ts`
**Date:** September 26, 2025

**Key Changes:**
- ‚úÖ **Multi-Format Generation**: Modified router to generate all three address formats simultaneously
- ‚úÖ **Backward Compatibility**: Maintained single-format mode when `format` parameter is specified
- ‚úÖ **Formatted Display**: Added `formattedDisplay` property with protocol-prefixed addresses
- ‚úÖ **Promise.all Optimization**: Parallel generation of all address formats for better performance

**Implementation:**
```typescript
// Multi-format mode: Generate all three address formats
const [p2pkhResult, p2shResult, p2wpkhResult] = await Promise.all([
  litecoinP2PKHData.deriveFromPrivateKey(privateKey),
  litecoinP2SHData.deriveFromPrivateKey(privateKey),
  litecoinP2WPKHData.deriveFromPrivateKey(privateKey)
]);

// Create formatted multi-line display: P2PKH://address\nP2SH://address\nP2WPKH://address
const formattedDisplay = `P2PKH://${p2pkhResult.address}\nP2SH://${p2shResult.address}\nP2WPKH://${p2wpkhResult.address}`;
```

### 2. Extended DerivedInfo Interface
**Location:** `src/components/currencies/currencyData.ts`
**Date:** September 26, 2025

**Added Properties:**
- ‚úÖ **`formattedDisplay`**: Multi-line formatted address display
- ‚úÖ **Litecoin Format Properties**: `p2pkhAddress`, `p2shAddress`, `p2wpkhAddress`
- ‚úÖ **Backward Compatibility**: Aliases like `rawP2PKHAddress`, `rawP2SHAddress`, `rawP2WPKHAddress`

### 3. TemporaryKeyModal Litecoin Integration
**Location:** `src/components/accessControl/authentication/loginStandard/options/TemporaryKeyModal.tsx`
**Date:** September 26, 2025

**Key Features:**
- ‚úÖ **Pill Switcher Support**: Added LTC to existing DOT pill switcher logic
- ‚úÖ **Conditional Rendering**: Extended address display logic to handle LTC formats
- ‚úÖ **Smart Copy Button**: Updated copy logic to handle LTC format selection
- ‚úÖ **Fallback Display**: Shows all formats when no selection is made

**Integration Logic:**
```typescript
// Support both DOT and LTC multi-format addresses
{(ticker === "DOT" || ticker === "LTC") && derived.formattedDisplay && (
  <QrCodeMultFormatAddressDisplay
    formattedDisplay={derived.formattedDisplay}
    onAddressChange={handleAddressChange}
  />
)}
```

## User Experience Improvements

### Before Implementation:
```
[QR Code - only P2PKH]
Address: LP2PKH_ADDRESS_HERE
[Copy Button]
```
*Users had to manually change format selection to get different address types*

### After Implementation:
```
[QR Code - switches dynamically]
[P2PKH] [P2SH] [P2WPKH] ‚Üê Pill buttons
P2PKH://LP2PKH_ADDRESS_HERE    ‚Üê Selected format shown
[Smart Copy Button] ‚Üê Copies selected format
```

### Benefits:
- **üéØ Format Flexibility**: Instant switching between all Litecoin address formats
- **üì± Better UX**: Visual format selection with immediate QR code updates
- **üîÑ Dynamic Updates**: Address display and copy functionality adapt to selection
- **üìã Smart Copying**: Copy button copies the currently selected format
- **‚ö° Performance**: Parallel address generation for faster loading

## Technical Implementation Details

### Address Format Details:
- **P2PKH (Legacy)**: Base58, starts with 'L', most compatible but higher fees
- **P2SH (SegWit Compatible)**: Base58, starts with 'M', wrapped SegWit benefits
- **P2WPKH (Native SegWit)**: Bech32, starts with 'ltc1', best fees and features

### QR Code Compatibility:
- All formats generate scannable QR codes
- Error correction level H (30%) ensures reliability
- Proper encoding for special characters in Bech32 addresses

### State Management:
- **Selection Tracking**: `selectedNetwork` state tracks current format (P2PKH/P2SH/P2WPKH)
- **QR Code Updates**: `qrCodeAddress` updates dynamically on format changes
- **Copy Intelligence**: Copy button adapts to current selection

## Testing & Validation
- ‚úÖ **TypeScript Compilation**: Clean compilation with extended interfaces
- ‚úÖ **Address Generation**: All three formats generate correctly and uniquely
- ‚úÖ **QR Code Scanning**: All formats produce scannable QR codes
- ‚úÖ **Pill Switching**: Smooth transitions between address formats
- ‚úÖ **Copy Functionality**: Copy button works for selected format
- ‚úÖ **Backward Compatibility**: Single-format mode still works for existing code

## Files Modified
1. `src/components/currencies/LTC.Litecoin.ts` - Multi-format address generation
2. `src/components/currencies/currencyData.ts` - Extended DerivedInfo interface
3. `src/components/accessControl/authentication/loginStandard/options/TemporaryKeyModal.tsx` - UI integration

## Impact
This implementation provides Litecoin users with the same multi-format address flexibility that Polkadot users enjoy. Users can now easily switch between different address formats to optimize for compatibility, fees, or modern features, with a clean and intuitive interface that matches the established design patterns.

The implementation establishes a consistent pattern for multi-format cryptocurrencies, making it easy to extend this functionality to other coins like Bitcoin in the future.
