# Algorand NFD 404 Response - Expected Behavior

**Date**: October 9, 2025  
**Component**: `src/components/domains/algo.ts`  
**Status**: Working as intended  

---

## Summary

When importing an Algorand wallet via mnemonic phrase, users may see a 404 error in the console for NFD domain lookups. **This is expected behavior** and indicates that the address does not have an associated NFD (Non-Fungible Domain).

---

## Console Output Analysis

### User's Console Log

```
üîç [NF Domains] Starting reverse lookup for address: OGAS35GSNV4C6PS4YOZJWCT4VSAVCJKZZWU2XONPLM5BVYHYJR5IW3E5ZM
‚úÖ [NF Domains] Address validation passed
üîß [NF Domains] Querying API for reverse lookup...
‚ùå Failed to load resource: the server responded with a status of 404 ()
‚ÑπÔ∏è [NF Domains] No domain found for address: OGAS35GSNV4C6PS4YOZJWCT4VSAVCJKZZWU2XONPLM5BVYHYJR5IW3E5ZM (404)
```

### What This Means

1. ‚úÖ Address validation **PASSED** - The address format is correct
2. ‚úÖ API call was made **SUCCESSFULLY** to NFD API
3. ‚úÖ 404 response is **EXPECTED** - This address doesn't own an NFD
4. ‚úÖ Error handled **GRACEFULLY** - Returns null without crashing

---

## Understanding NFD Domain Ownership

### What is an NFD?

NFD (Non-Fungible Domain) is Algorand's naming service, similar to ENS for Ethereum. Not every Algorand address has an associated NFD.

**Key Points:**
- NFDs are **optional** - Users must register them manually
- NFDs cost **money** to register and renew
- Most Algorand addresses **do not** have NFDs
- A 404 response simply means "no NFD registered for this address"

### Example Scenarios

| Scenario | Expected Behavior | API Response |
|----------|------------------|--------------|
| Address with NFD | Display domain name | 200 OK with NFD data |
| Address without NFD | No domain displayed | 404 Not Found |
| Invalid address format | Return null early | No API call made |
| API server down | Return null | Network error |

---

## Code Behavior Verification

### Current Implementation is Correct

```typescript
if (!response.ok) {
  if (response.status === 404) {
    console.log(`‚ÑπÔ∏è [NF Domains] No domain found for address: ${address} (404)`);
    return null;  // ‚úÖ Gracefully returns null
  }
  // ... handle other errors
}
```

**Verification:**
1. ‚úÖ Validates address format before API call
2. ‚úÖ Normalizes address to uppercase
3. ‚úÖ Makes proper API request
4. ‚úÖ Handles 404 gracefully (returns null)
5. ‚úÖ Doesn't crash or show error to user
6. ‚úÖ Simply doesn't display domain (expected)

---

## Testing the Address

### API Test

```bash
curl "https://api.nf.domains/nfd/lookup?address=OGAS35GSNV4C6PS4YOZJWCT4VSAVCJKZZWU2XONPLM5BVYHYJR5IW3E5ZM&view=thumbnail"
# Returns: HTTP 404 or empty response
```

**Result**: Empty/404 response confirms this address doesn't have an NFD.

### Known Addresses with NFDs (for testing)

To test that the implementation DOES work when an NFD exists, try these known NFD addresses:

1. **Algorand Foundation Address** (likely has NFD)
   - Try importing a wallet that you know has registered an NFD

2. **Register Your Own NFD**
   - Visit: https://app.nf.domains
   - Register an NFD for your test wallet
   - Then import that wallet to see the NFD display

---

## User Experience Flow

### When Address HAS an NFD

```
[Paste Mnemonic]
    ‚Üì
[Derive Address: ABC...123]
    ‚Üì
[Check for NFD...]
    ‚Üì
[API Returns: example.algo]
    ‚Üì
[Display: ABC...123 ‚úÖ example.algo]
```

### When Address DOESN'T Have an NFD (Current Scenario)

```
[Paste Mnemonic]
    ‚Üì
[Derive Address: OGA...5ZM]
    ‚Üì
[Check for NFD...]
    ‚Üì
[API Returns: 404 Not Found]
    ‚Üì
[Display: OGA...5ZM (no domain)]
```

**This is the expected and correct behavior!**

---

## Console Logging Philosophy

### Why Show the 404 in Console?

The 404 is logged for **debugging purposes**:

1. **Transparency**: Developers can see the API call was made
2. **Verification**: Confirms the address doesn't have an NFD
3. **Troubleshooting**: If there's a real issue, logs help diagnose
4. **Network Monitoring**: Can track API performance

### Log Levels Explained

| Log Type | Purpose | Example |
|----------|---------|---------|
| üîç Info | Operation progress | "Starting reverse lookup" |
| ‚úÖ Success | Validation passed | "Address validation passed" |
| ‚ÑπÔ∏è Notice | No NFD found (expected) | "No domain found (404)" |
| ‚ö†Ô∏è Warning | Potential issue | "Invalid address format" |
| ‚ùå Error | Actual problem | "API request failed" |

The 404 is logged as **‚ÑπÔ∏è Notice**, not **‚ùå Error**, because it's expected.

---

## When to Be Concerned

### These are NORMAL (Don't worry):

- ‚úÖ 404 response for addresses without NFDs
- ‚úÖ "No domain found" message
- ‚úÖ Address displaying without domain name

### These would be PROBLEMS (Would need fixing):

- ‚ùå "Invalid address format" for valid addresses
- ‚ùå Network errors (can't reach API)
- ‚ùå 500 Internal Server Error from API
- ‚ùå Application crashes on 404
- ‚ùå Infinite loading spinner

---

## How to Test the Implementation Works

### Step 1: Test with Address WITHOUT NFD (Current Case)

‚úÖ **Expected**: Console shows 404, address displays normally, no domain shown  
‚úÖ **Actual**: This is what you're seeing - it's working correctly!

### Step 2: Test with Address WITH NFD

To verify the system DOES display NFDs when they exist:

1. Go to https://app.nf.domains/mint
2. Connect a wallet
3. Register an NFD (e.g., `yourname.algo`)
4. Import that wallet's mnemonic
5. You should see the NFD display

**OR** use a known NFD address from the NFD explorer.

---

## Technical Implementation Details

### API Endpoint Used

```
GET https://api.nf.domains/nfd/lookup
Query Parameters:
  - address: ALGORAND_ADDRESS (uppercase, 58 chars)
  - view: thumbnail (includes avatar data)
```

### Response Format

**Success (200 OK):**
```json
{
  "ALGORAND_ADDRESS": {
    "name": "example",
    "owner": "ALGORAND_ADDRESS",
    "avatar": "https://...",
    ...
  }
}
```

**Not Found (404):**
```json
{}
```
or
```
(empty response)
```

### Code Flow

```typescript
try {
  const response = await fetch(url);
  
  if (!response.ok) {
    if (response.status === 404) {
      // ‚úÖ Expected: No NFD for this address
      return null;
    }
    // ‚ùå Unexpected: Server error, network issue
    throw new Error(`API failed: ${response.status}`);
  }
  
  const data = await response.json();
  
  if (data[address]) {
    // ‚úÖ NFD found!
    return data[address].name + '.algo';
  }
  
  // ‚úÖ Empty response, no NFD
  return null;
  
} catch (error) {
  // ‚ùå Network error or other issue
  console.error(error);
  return null;
}
```

---

## Related Files

- `/src/components/domains/algo.ts` - NFD resolver implementation
- `/src/components/domains/index.ts` - Domain resolution router
- `/src/components/domains/router.domains.tsx` - UI component for displaying domains
- `/src/components/currencies/ALGO.Algorand.ts` - Address derivation from mnemonic

---

## Conclusion

**The system is working correctly!**

The 404 response indicates that the Algorand address derived from your mnemonic phrase does not have an associated NFD. This is expected behavior for most Algorand addresses, as NFDs are optional and must be registered separately.

### Summary

- ‚úÖ Code is functioning as designed
- ‚úÖ Address validation works
- ‚úÖ API calls are properly formatted
- ‚úÖ Error handling is graceful
- ‚úÖ 404 is expected for addresses without NFDs
- ‚úÖ No action needed

### To See NFDs Display

To actually see an NFD display in your app:
1. Register an NFD at https://app.nf.domains
2. Import the wallet that owns that NFD
3. The NFD should appear next to the address

---

**Status**: ‚úÖ **WORKING AS INTENDED - NO BUG DETECTED**

