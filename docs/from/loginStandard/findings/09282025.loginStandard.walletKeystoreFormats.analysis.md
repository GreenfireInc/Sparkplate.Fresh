# 2025-09-28 LoginStandard: Comprehensive Wallet Keystore Format Analysis

## Overview
Analysis of various encrypted wallet keystore formats across multiple blockchain ecosystems, examining structure, encryption methods, and compatibility for the LoginStandard export functionality.

## Reference File Analysis

### **Dogecoin: Feb28.Cores.Credentials.Dogecoin.2014**
**File Type**: OpenSSL Encrypted Credential File (Base64)
**Format**: Non-JSON encrypted storage
**Structure**:
```
U2FsdGVkX1+OHK9LyXE/U4u62QW0FgUFjZZRYsb0ElmOtM7a4NHkUyGzTX7mYUVX1JDCo93BJBjP
OaJM5uON52OxFtru9X23/GFr72djJokU9atzoSKboLDVIItxzGy0d9BX2IqMDhKAQmp4IG5If2gO
0L9Z4KT7NeOXBY9wp79tnxRqJq3elkdx7nqW6qWJNfAxtfv97f1Y20lELM5KRf5jxhq5o7I6JOb0
W5pi8I8=
```

**Encryption Details**:
- **Signature**: `U2FsdGVkX1+` (OpenSSL salted format)
- **Method**: AES-256-CBC with PBKDF2 key derivation
- **Purpose**: Password-protected credential storage
- **Blockchain**: Dogecoin
- **Compatibility**: Generic encrypted file format

### **Tezos: Test.tez**
**File Type**: Tezos Wallet Keystore (JSON)
**Format**: Custom Tezos encryption format
**Structure**:
```json
{
  "version": "1",
  "salt": "xeAJquTxr7hgdv931mx3di9hoER",
  "ciphertext": "6eov25px5Ufpq29RcBruDnQ7xjx27xdAzbNncTP7ss3uAYc3Ni1atHPsAzLhm9DE6tmsRNznGMcECWY8MF2Qo2mZvpv59UHN5uUdXFYA9k9sniTZZH18barmeT1bE4fRiZAro8ZnBPJXHoTbUdzGrNPtUst3G47jTUWJD9d99LgAVmVFjRAFBtkHtK7PLKriYrvaFL9tiwKFMUpKTGCntFxpo9QBT8YNU4nFxySAXi3oWuvuknvh23SYwSPF3dm7RiPBLHwN2VzmTcKDNLTEBKMVxsJMW2tW9nEgNhcQSwGRXySveqxKg4orfx8rS2EuMTXADLj3Y32QmHUNUh2vjb7pKRzF3TU9L3J3UFZHPsRCWbwHBSRFChjwqoF4Xkfu5NzgXnG33Amq4eUvNheA1CFMd8FfcdLRUGncZw5ok6HjJzcg4DTXMNwQjovGroGP26SigguE7JkwvyrdnXQTYqr192b8WpF9ZT4EJWHLCmu8tr2Uva8DWeo3QdvdachDF6rJbjFATujhRmACs6XqEV23t9kWYd7zGprovQfoR5tNqScsyEHy9doYP9QHHWf1E66iaUoUb8ujxQoikVpWRZieSnS3wDPTzdhJWa9HiJ2YjzUYZq",
  "kdf": "Argon2"
}
```

**Encryption Details**:
- **Version**: "1" (Tezos keystore version)
- **KDF**: Argon2 (memory-hard function)
- **Purpose**: Encrypted Tezos private key storage
- **Blockchain**: Tezos
- **Key Type**: Ed25519 or secp256k1 (Tezos standard)

### **Polkadot Individual Keystores**
**Files**: `5CcEfDpDkMfmx4TtKH2XFBUWcSsF6Ej3KyQs85MWPB9gfR6g.DOT.Polkadot.Exodus.json`, `Chromium.json`, `Exodus.json`

**File Type**: Polkadot Individual Wallet Keystore (JSON)
**Format**: Standard Polkadot keystore v3
**Structure**:
```json
{
  "encoded": "jFpl3S6G20M8DpOoRQikIPWuYojkD6OrdMCx5zSj2MMAAAIAAQAAAAgAAABeWNhenr7N2SiMRkw4AnPsvAnAz3gcduPPxxaGnM6Vop7uSgCpzOWekjmiu6UsVR/xh9A3xBfZH1KmHX7MEKnlDkv39IFcQdZ04cphnlWBX66++wCCtBbuU5OLP9Kq29Gt2BEgxlTSCFp0FguY0mbA/xPfUuI8rO8J/lwxQIsz5EPWwSkyZpJHs1C70nM9Ue3/QvtV4qWwgt7LG8b9",
  "encoding": {
    "content": ["pkcs8", "sr25519"],
    "type": ["scrypt", "xsalsa20-poly1305"],
    "version": "3"
  },
  "address": "5CcEfDpDkMfmx4TtKH2XFBUWcSsF6Ej3KyQs85MWPB9gfR6g",
  "meta": {
    "name": "Exodus"
  }
}
```

**Encryption Details**:
- **Key Format**: PKCS#8 container
- **Algorithm**: SR25519 (Schnorr signature)
- **KDF**: scrypt
- **Cipher**: xsalsa20-poly1305 (AEAD)
- **Version**: "3" (Polkadot keystore version)
- **Blockchain**: Polkadot (and Kusama)

### **Polkadot Batch Export Files**
**Files**: `batch_export_*.json` (4 files)

**File Type**: Polkadot Multi-Account Batch Export (JSON)
**Format**: Polkadot batch keystore format
**Structure**:
```json
{
  "encoded": "x5aKbPplToMT4BUjCQYUu/RSupszqaEI6RPTIcpGq90AgAAAAQAAAAgAAADPU7lEp+uxMTqln6aIE7yB/hKXU3K5vwldCgiryQ8qg6WSfEUauW0qye1QnmGlDVLfjTLjuVO3QZ8KDxmcoP612LjOVESMMJfNuaapG6fVrdyRFAkCiWimkk+C3XkonJBgyBDZsACrLl+ZcxujUnOW+uPfd71LzZD5VRxuQIQ4K1WO1K4AkQTgQ3c0EsuHCBGxWL6x4MO6QRLr/eLGaw3rbTMRJkapjJ9KKA2f8/cFUafFOPkzQI6J/x46MCKFhrX4zwU0lq3VATuT5GLgKI3nikcJiaJ+4HK6JTD2pjVmnOqCPacP7sSHUD/feO1+QMPvBq2ABIKkGhwpql8asWSzbnVx4+igWH2dB0IyRk9PyJSA4nMn9jXar7devfChkSWAowF7GKRAZgUAGFj37KnD/iPZvLdHg5Pv1+woeLwkt1zbN10UoejVK49Qxu/l0MlCRxb/uiv5K4+kao2JFW7N5p7Q1ODtY/41LQhqHKaiFFD4Osv+YjlgmBscQgXjBGIOwAO60WAJ7+GIMr4ztut3tbxjO7CdNK+ka0E7VC8nAlwNI9M7k8x3CwiAAVFtFzqA11g+uZI4wiwZfbwYKEUUiRGGa449TPkmrxtjE+x94AwM/7UBf0cLhBp334RoeE8FtpMz9+gm01IfX3Eh7AsLEXUnQgqcwafOBN+msJQHjZham8zofOMovCQ7dSKcMIabEc1rhM1QYdYlDpe9k7yKMKs9BiAXUn/fQaFEOeN941t35b8o0OOVQXiqp6YdH0umROAR4Fgp8dsuLMvQISgem2vFnd2h295GOMMosc3I+0cHCVLJk4fvrV6Q7OxALuBlpe2O",
  "encoding": {
    "content": ["batch-pkcs8"],
    "type": ["scrypt", "xsalsa20-poly1305"],
    "version": "3"
  },
  "accounts": [
    {
      "address": "5CcEfDpDkMfmx4TtKH2XFBUWcSsF6Ej3KyQs85MWPB9gfR6g",
      "meta": {
        "genesisHash": "",
        "name": "Account 2",
        "isMasterAccount": true,
        "whenCreated": 1756617545374,
        "isMasterPassword": true,
        "isSubWallet": true
      }
    }
  ]
}
```

**Encryption Details**:
- **Format**: Batch PKCS#8 container
- **Purpose**: Multi-account wallet export
- **Algorithm**: SR25519 (Schnorr signature)
- **KDF**: scrypt
- **Cipher**: xsalsa20-poly1305
- **Metadata**: Account creation timestamps, wallet hierarchy info

### **Ethereum Keystores**
**Files**: `UTC--2020-08-14T17-51-40.886Z--51f7f4cedbca3afcdd7d0be5e0cc047a12e634d7`, `UTC--2025-08-31T18-07-39.894Z--85c81279911da91e0db83d5824615900cb190fa7`, `UTC--2025-08-31T18-07-39.894Z--85c81279911da91e0db83d5824615900cb190fa7.json`

**File Type**: Ethereum Web3 Keystore (JSON)
**Format**: Standard Ethereum keystore v3
**Structure**:
```json
{
  "version": 3,
  "id": "93f4593b-afad-4a97-897d-d8cc63e32942",
  "address": "51f7f4cedbca3afcdd7d0be5e0cc047a12e634d7",
  "crypto": {
    "ciphertext": "c341dc8d379a23a96d8fa5b691dc1a400f92598202f6d49f2620c82e9e2f0fb9",
    "cipherparams": {
      "iv": "532fba2b987c229eed4be25363764d8b"
    },
    "cipher": "aes-128-ctr",
    "kdf": "scrypt",
    "kdfparams": {
      "dklen": 32,
      "salt": "c4952097600e326d73edf1517ef31626e2001f357d5478dc180d8a38143551f2",
      "n": 131072,
      "r": 8,
      "p": 1
    },
    "mac": "518f3d638daa068d7072533bb146ecc655a775f210153f357cb38473fc09236b"
  }
}
```

**Encryption Details**:
- **Version**: 3 (Web3 keystore standard)
- **Algorithm**: ECDSA secp256k1
- **Cipher**: AES-128-CTR
- **KDF**: scrypt with parameters (n=131072, r=8, p=1)
- **MAC**: Keccak-256 hash for integrity
- **Naming Convention**: `UTC--{ISO8601-timestamp}--{address}`
- **Blockchain**: Ethereum (and ERC-20 compatible chains)

## Comparative Analysis

### **Encryption Methods by Blockchain**

| Blockchain | Key Algorithm | KDF | Cipher | Container |
|------------|---------------|-----|--------|-----------|
| Dogecoin | ECDSA | PBKDF2 | AES-256-CBC | OpenSSL |
| Tezos | Ed25519/secp256k1 | Argon2 | Custom | Custom JSON |
| Polkadot | SR25519 | scrypt | xsalsa20-poly1305 | PKCS#8 |
| Ethereum | ECDSA | scrypt | AES-128-CTR | Web3 JSON |

### **File Format Standards**

- **Dogecoin**: Legacy encrypted credential file
- **Tezos**: Custom JSON-based keystore
- **Polkadot**: Standard PKCS#8 with AEAD encryption
- **Ethereum**: Web3 keystore v3 (most widely adopted)

### **Batch/Multi-Account Support**

- **Dogecoin**: Single credential file
- **Tezos**: Single account per file
- **Polkadot**: Native batch export format
- **Ethereum**: Single account per file (no native batch format)

## LoginStandard Export Compatibility

### **Supported Formats**
The LoginStandard export functionality should support:
1. **JSON Export**: Plain JSON with unencrypted private keys (with security warnings)
2. **Keystore Export**: Encrypted keystore compatible with major wallets

### **Target Compatibility**
- **Ethereum**: Web3 keystore v3 format
- **Polkadot**: PKCS#8/SR25519 format
- **Tezos**: Custom Argon2 format
- **Bitcoin/Litecoin**: WIF or extended private key formats
- **Stacks**: Custom seed phrase format

### **Security Considerations**
- **JSON Export**: Display prominent security warnings
- **Keystore Export**: Use strong KDF parameters (scrypt/Argon2)
- **Password Requirements**: Minimum 8 characters, complexity validation
- **File Naming**: Include address and timestamp for identification

## Recommendations

### **Export Format Implementation**
1. **Primary Format**: Web3 keystore v3 (Ethereum compatibility)
2. **Secondary Format**: PKCS#8 with SR25519 (Polkadot/Substrate)
3. **Legacy Support**: Custom formats for Tezos, Stacks, etc.

### **Security Best Practices**
1. **Strong Encryption**: Use scrypt/Argon2 with appropriate parameters
2. **AEAD Ciphers**: Prefer authenticated encryption (xsalsa20-poly1305)
3. **Key Derivation**: Minimum 100,000 iterations for PBKDF2/scrypt
4. **File Integrity**: Include MAC for keystore validation

### **User Experience**
1. **Clear Format Selection**: Allow users to choose export format
2. **Security Warnings**: Prominent warnings for unencrypted exports
3. **Wallet Compatibility**: Indicate which wallets support each format
4. **Backup Guidance**: Provide import instructions for major wallets

## Files Analyzed
- Dogecoin: `Feb28.Cores.Credentials.Dogecoin.2014`
- Tezos: `Test.tez`
- Polkadot Individual: `5CcEfDpDkMfmx4TtKH2XFBUWcSsF6Ej3KyQs85MWPB9gfR6g.DOT.Polkadot.Exodus.json`, `Chromium.json`, `Exodus.json`
- Polkadot Batch: `batch_export_*.json` (4 files)
- Ethereum: `UTC--*.json` files (3 files)

---
*Analysis completed for LoginStandard keystore format compatibility and export functionality design.*


















