# Polkadot Export Formats Guide
**Date:** September 30, 2025  
**Issue:** Understanding which export format to use for Polkadot wallet compatibility  
**Status:** ‚úÖ RESOLVED

---

## üìã **The Issue**

LoginStandard offers multiple export formats, but not all are compatible with Polkadot wallets (Talisman, SubWallet, Nova Spektr, Enkrypt). This guide clarifies which format to use.

## ‚ùå **What DOESN'T Work: Plain JSON Export**

### **File Example:**
```
user.Linux_x86_64.DOT.14fE5qfnn1sqmbynkMvmEx4DFuNEe4UMLLTkb3tjaKeT7yV4.20250930_172940.json
```

### **Content:**
```json
{
  "version": 1,
  "currency": "DOT",
  "privateKey": "897b7779baa17fcfcd0f335cf1d9729a2b17cbabe98278384793e68c8b30273a",
  "publicKey": "0xa1dc1188522e539e5ec290086599873e60c9c7ac1ad72f98d1de8cc6e922ea41",
  "address": "14fE5qfnn1sqmbynkMvmEx4DFuNEe4UMLLTkb3tjaKeT7yV4",
  "exportDate": "2025-09-30T21:29:40.504Z",
  "exportedBy": "LoginStandard",
  "warning": "‚ö†Ô∏è KEEP THIS FILE SECURE - Contains unencrypted private key"
}
```

### **Why It Doesn't Work:**
- ‚ùå **Custom Format** - This is LoginStandard's proprietary format
- ‚ùå **Not Recognized** - Polkadot wallets don't understand this structure
- ‚ùå **Unencrypted** - Contains raw private key (security risk)
- ‚ùå **No PKCS#8 Encoding** - Missing required key encoding
- ‚ùå **Wrong Structure** - Lacks `encoded`, `encoding`, `meta` fields

### **What It's Good For:**
- ‚úÖ Manual backup within LoginStandard
- ‚úÖ Copying private keys between your own devices
- ‚úÖ Developer debugging
- ‚úÖ Quick reference for addresses
- ‚ùå **NOT for importing into Polkadot wallets**

---

## ‚úÖ **What WORKS: Encrypted Keystore Export**

### **File Example:**
```
user.Linux_x86_64.DOT.14fE5qfnn1sqmbynkMvmEx4DFuNEe4UMLLTkb3tjaKeT7yV4.20250930_173000.keystore
```

### **Content:**
```json
{
  "encoded": "qZwrXD25Hkw9cFsOMcnbSQ3xsIPSF3PBNMotrx4O3tQAAAIAAQAAAAgAAADIVF3RXUTk9t0stAB01mp0h153wDhA8baRsSPOq7cT1uUZ3Sp/Dwdf2oBeiSgvPBVcQDVURGQbtq1CG3/r62kw0QiNAKkBdjbTiPLCmVMOi0iFozUiko5ylBy1DpQefWKZzArsbu/qYKVu3wOYO/zWqwAw7ukbO96iaM66S44QPvUJeaUYRllsuPdt8fKvm5GwJkEfgGxh53qMeO9W",
  "encoding": {
    "content": ["pkcs8", "sr25519"],
    "type": ["scrypt", "xsalsa20-poly1305"],
    "version": "3"
  },
  "address": "5CcEfDpDkMfmx4TtKH2XFBUWcSsF6Ej3KyQs85MWPB9gfR6g",
  "meta": {
    "name": "DOT Account",
    "whenCreated": 1727726000000
  }
}
```

### **Why It Works:**
- ‚úÖ **Official Format** - Standard Polkadot.js keystore structure
- ‚úÖ **Recognized by All Wallets** - Talisman, SubWallet, Nova Spektr, Enkrypt
- ‚úÖ **Encrypted** - Uses scrypt + xsalsa20-poly1305 (industry standard)
- ‚úÖ **PKCS#8 Encoded** - Proper private key encoding
- ‚úÖ **Correct Structure** - Has `encoded`, `encoding`, `meta` fields
- ‚úÖ **Password Protected** - Secure encryption

### **What It's Good For:**
- ‚úÖ **Importing into any Polkadot wallet**
- ‚úÖ Secure backup with password protection
- ‚úÖ Sharing between wallets (with password)
- ‚úÖ Long-term storage

---

## üéØ **Step-by-Step Guide**

### **How to Export for Wallet Import:**

1. **Open LoginStandard**
   - Navigate to your Polkadot account
   - Click on "Export Private Key"

2. **Select the Correct Format**
   - ‚ö†Ô∏è **DO NOT** select "JSON File"
   - ‚úÖ **SELECT** "Encrypted Keystore"
   - Look for the label: "‚úÖ Wallet compatible"

3. **Enter a Password**
   - Modal will open asking for password
   - Enter a strong password
   - Confirm the password
   - Remember this password (you'll need it for import)

4. **Download the File**
   - File will be named: `user.{machine}.DOT.{address}.{datetime}.keystore`
   - Save it securely
   - This file contains your encrypted private key

5. **Import into Polkadot Wallet**
   - Open your wallet (Talisman, SubWallet, etc.)
   - Select "Import from JSON" or "Restore JSON"
   - Upload the `.keystore` file
   - Enter the password you used in step 3
   - ‚úÖ Success! Your account is imported

---

## üìä **Export Format Comparison**

| **Feature** | **Plain JSON** | **Encrypted Keystore** |
|-------------|---------------|----------------------|
| **File Extension** | `.json` | `.keystore` |
| **Encryption** | None | scrypt + xsalsa20-poly1305 |
| **Password Required** | No | Yes |
| **Wallet Compatible** | ‚ùå No | ‚úÖ Yes |
| **PKCS#8 Encoding** | ‚ùå No | ‚úÖ Yes |
| **LoginStandard Compatible** | ‚úÖ Yes | ‚úÖ Yes |
| **Talisman Compatible** | ‚ùå No | ‚úÖ Yes |
| **SubWallet Compatible** | ‚ùå No | ‚úÖ Yes |
| **Nova Spektr Compatible** | ‚ùå No | ‚úÖ Yes |
| **Enkrypt Compatible** | ‚ùå No | ‚úÖ Yes |
| **Security Level** | Low (unencrypted) | High (encrypted) |
| **Use Case** | Internal backup | Wallet import/export |

---

## üîç **Technical Details**

### **Plain JSON Export (LoginStandard Custom):**
- **Structure:** Custom LoginStandard schema
- **Private Key:** Raw hex string (64 characters)
- **Public Key:** Hex with 0x prefix
- **Address:** SS58 encoded Polkadot address
- **Encryption:** None
- **Purpose:** Quick backup, debugging, manual recovery

### **Encrypted Keystore Export (Polkadot Standard):**
- **Structure:** Polkadot.js KeyringPair$Json format
- **Private Key:** PKCS#8 encoded, then encrypted with scrypt + xsalsa20-poly1305
- **Encoded Field:** Base64-encoded encrypted data
- **Encoding Field:** Specifies content type (pkcs8, sr25519) and encryption (scrypt, xsalsa20-poly1305)
- **Address:** SS58 encoded Polkadot address
- **Meta:** Account metadata (name, creation time)
- **Purpose:** Cross-wallet compatibility, secure storage

---

## üõ†Ô∏è **Implementation Reference**

### **Code Location:**
```
src/components/currencies/ext.DOT.Polkadot/DOT.Polkadot.Export.ts
```

### **Function:**
```typescript
exportPolkadotKeystore(
  privateKeyHex: string,
  password: string,
  metadata?: { name?: string; address?: string }
): Promise<PolkadotKeystoreJson>
```

### **Integration:**
```typescript
// In Exporting.tsx
if (currency === 'DOT' && polkadotData.exportKeystore) {
  keystore = await polkadotData.exportKeystore(privateKey, password, {
    name: `${currency} Account`,
    address: address
  });
}
```

---

## üìö **References**

### **Wallet Import Documentation:**
- **Talisman:** Uses `createPairFromJson()` + `decodePkcs8()`
- **SubWallet:** Uses `jsonRestoreV2()` with KeyringPair$Json validation
- **Nova Spektr:** Standard Polkadot.js keyring approach
- **Enkrypt:** Uses `decodePair()` with PKCS#8 decryption

### **Polkadot.js Standards:**
- KeyringPair$Json interface
- PKCS#8 encoding (RFC 5208)
- scrypt key derivation (RFC 7914)
- XSalsa20-Poly1305 encryption (RFC 7905)

---

## ‚ö†Ô∏è **Common Mistakes**

### **Mistake 1: Using Plain JSON**
```
‚ùå Exporting: "JSON File" format
‚úÖ Correct: "Encrypted Keystore" format
```

### **Mistake 2: Forgetting Password**
```
‚ùå Result: Cannot import keystore into wallet
‚úÖ Solution: Remember password or export new keystore
```

### **Mistake 3: Using .json Extension**
```
‚ùå File: account.json (plain format)
‚úÖ File: account.keystore (encrypted format)
```

### **Mistake 4: Not Verifying Address**
```
‚ùå Importing without checking address matches
‚úÖ Verify imported address matches original
```

---

## üéØ **Quick Reference Card**

**Want to import into Polkadot wallet?**
‚Üí Use **"Encrypted Keystore"** format with password

**Want to backup for LoginStandard only?**
‚Üí Use **"JSON File"** format (no password needed)

**Want maximum security?**
‚Üí Use **"Encrypted Keystore"** format with strong password

**Want quick manual recovery?**
‚Üí Use **"JSON File"** format (keep secure!)

---

## ‚úÖ **Summary**

1. ‚ùå **Plain JSON** (`.json`) = LoginStandard internal use only
2. ‚úÖ **Encrypted Keystore** (`.keystore`) = Universal Polkadot wallet compatibility
3. Always use **"Encrypted Keystore"** for importing into other wallets
4. Remember your password - you'll need it for import
5. Verify the imported address matches your original address

**The fix is simple: Export using "Encrypted Keystore" instead of "JSON File"!** üöÄ

---

*Last updated: September 30, 2025*  
*Implementation: DOT.Polkadot.Export.ts*  
*UI Enhancement: Added wallet compatibility labels*

