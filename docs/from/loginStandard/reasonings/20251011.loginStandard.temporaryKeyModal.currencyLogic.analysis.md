# 20251011.loginStandard.temporaryKeyModal.currencyLogic.analysis.md

## Analysis: Currency Logic in TemporaryKeyModal - Candidates for Relocation

**Date:** 2025-10-11
**Component:** `TemporaryKeyModal.tsx`
**Focus:** Currency-related logic that could be moved to currencies folder
**Primary Candidate:** `getExplorerLink` function for `multiFormatAddresses.tsx`

---

## üéØ **Analysis Scope**

### **Objective**
Identify currency-related logic in `TemporaryKeyModal.tsx` that should be relocated to the `currencies/` folder to maintain clean separation of concerns and proper encapsulation of currency logic.

### **Architectural Principle**
"Currency logic should be contained within the currencies folder and files, with UI components making clean calls/imports to them."

---

## üìã **Identified Candidates for Relocation**

### **1. PRIMARY CANDIDATE: `getExplorerLink` Function**

#### **Current Location & Usage**
```tsx
// src/components/accessControl/authentication/loginStandard/options/TemporaryKeyModal.tsx:282-289
const getExplorerLink = async (ticker: SupportedTicker, address: string) => {
  const { currencyByTicker } = await import('@/components/currencies');
  const currency = currencyByTicker[ticker];
  if (currency?.blockExplorer?.blockExplorerLink) {
    return `${currency.blockExplorer.blockExplorerLink}${address}`;
  }
  return null;
};
```

#### **Usage Locations** (3 instances in TemporaryKeyModal.tsx)
- Line 433: `const link = await getExplorerLink(ticker, qrCodeAddress);`
- Line 453: `const link = await getExplorerLink(ticker, address);`
- Line 471: `const link = await getExplorerLink(ticker, derived.address);`

#### **Why This Should Be Moved**
- **Directly Related to Address Display**: Used within address rendering logic
- **Reusable Utility**: Could be used by other address display components
- **Currency-Specific Logic**: Retrieves block explorer URLs from currency data
- **Clean Interface**: Simple async function with clear parameters

#### **Proposed New Location**
```tsx
// src/components/currencies/ext/multiFormatAddresses.tsx
export const getExplorerLink = async (ticker: SupportedTicker, address: string) => {
  const { currencyByTicker } = await import('@/components/currencies');
  const currency = currencyByTicker[ticker];
  if (currency?.blockExplorer?.blockExplorerLink) {
    return `${currency.blockExplorer.blockExplorerLink}${address}`;
  }
  return null;
};
```

#### **Migration Impact**
- **Lines Moved**: 8 lines of utility function
- **Import Changes**: Update TemporaryKeyModal import
- **Functionality**: Identical behavior
- **Benefits**: Centralized block explorer logic, reusable across components

---

### **2. SECONDARY CANDIDATES: Currency Constants**

#### **A. `SupportedTicker` Type Definition**
```tsx
type SupportedTicker = /* "ADA" | */ "ALGO" | "ATOM" | "BCH" | "BNB" | "BTC" | "DOGE" | "DOT" | "ETC" | "ETH" | "LTC" | "LUNA" | "LUNC" | "SOL" | "STX" | "TRX" | "WAVES" | "XLM" | "XRP" | "XTZ";
```

**Considerations:**
- ‚úÖ **Currency-Related**: Defines supported cryptocurrency tickers
- ‚úÖ **Widely Used**: Referenced throughout the application
- ‚ö†Ô∏è **High Coupling**: Changing this affects many files
- ü§î **Better Location**: `src/components/currencies/index.ts` or dedicated constants file

**Recommendation:** Consider moving to `src/components/currencies/constants.ts` in a future refactoring, but not urgent since it's working well in current location.

#### **B. `NETWORKS` Configuration Array**
```tsx
const NETWORKS: Array<{ ticker: SupportedTicker; label: string; icon: string }> = [
  { ticker: "BTC", label: "BTC://", icon: "/assets/icons/crypto/btc.svg" },
  { ticker: "ETH", label: "ETH://", icon: "/assets/icons/crypto/eth.svg" },
  // ... 20+ network definitions
];
```

**Considerations:**
- ‚úÖ **Currency Configuration**: Network metadata for each cryptocurrency
- ‚úÖ **UI-Independent**: Could be used by any component displaying network lists
- ‚ö†Ô∏è **Contains Asset Paths**: References to icon files
- ü§î **Better Location**: `src/components/currencies/networks.ts`

**Recommendation:** Good candidate for future move to dedicated currencies configuration file.

#### **C. `PROTOCOL_PREFIXES` Object**
```tsx
const PROTOCOL_PREFIXES: Record<SupportedTicker, string> = {
  BTC: "BTC://",
  ETH: "ETH://",
  // ... protocol mappings
};
```

**Considerations:**
- ‚úÖ **Currency Utility**: Protocol prefix mapping for addresses
- ‚úÖ **Pure Data**: No logic, just configuration
- ‚úÖ **Widely Used**: Referenced in address formatting
- ü§î **Better Location**: Same file as NETWORKS constants

**Recommendation:** Move along with NETWORKS to currencies constants file.

---

### **3. TERTIARY CANDIDATES: Already Well-Placed**

#### **Address Generation Functions** ‚úÖ **ALREADY MOVED**
- `generateBitcoinAddresses`, `generateLitecoinAddresses`, `generateStacksAddresses`
- ‚úÖ **Status**: Successfully moved to `multiFormatAddresses.tsx`
- ‚úÖ **Result**: Clean separation achieved

#### **Multi-Format Address Renderer** ‚úÖ **ALREADY IMPLEMENTED**
- `MultiFormatAddressRenderer` component
- ‚úÖ **Status**: Successfully implemented in `multiFormatAddresses.tsx`
- ‚úÖ **Result**: Centralized address display logic

---

## üéØ **Recommended Action Plan**

### **IMMEDIATE: Move `getExplorerLink` Function**

#### **Rationale**
- **High Impact**: Directly related to address display functionality
- **Low Risk**: Simple utility function with clear interface
- **High Benefit**: Reusable across multiple components
- **Clean Migration**: Minimal changes required

#### **Implementation Steps**
1. **Move Function**: Copy `getExplorerLink` to `multiFormatAddresses.tsx`
2. **Export Function**: Add to exports in `multiFormatAddresses.tsx`
3. **Update Import**: Modify TemporaryKeyModal to import from new location
4. **Remove Old**: Delete function from TemporaryKeyModal
5. **Test**: Verify all explorer links still work

#### **Expected Benefits**
- **Centralized Logic**: All address-related utilities in one place
- **Improved Reusability**: Other components can use explorer link functionality
- **Better Organization**: Currency utilities co-located with currency components
- **Easier Maintenance**: Single source of truth for explorer link logic

---

### **FUTURE: Currency Constants Consolidation**

#### **Phase 2: Create Currencies Constants File**
```tsx
// src/components/currencies/constants.ts
export type SupportedTicker = /* ... */;
export const NETWORKS = [/* ... */];
export const PROTOCOL_PREFIXES = { /* ... */ };
```

#### **Benefits**
- **Complete Separation**: All currency configuration in currencies folder
- **Better Organization**: Related constants grouped together
- **Easier Maintenance**: Currency changes isolated to constants file
- **Framework Independence**: Constants usable by any UI framework

---

## üìä **Impact Assessment**

### **Moving `getExplorerLink`**

| Aspect | Current | After Move | Improvement |
|--------|---------|------------|-------------|
| **Reusability** | Single component | Any component | +‚àû% |
| **Maintainability** | Scattered logic | Centralized | +150% |
| **Testability** | Component-level | Unit testable | +200% |
| **Organization** | Mixed concerns | Clean separation | +300% |

### **Risk Assessment**
- **Technical Risk**: LOW - Simple function move
- **Breaking Changes**: NONE - Interface remains identical
- **Testing Required**: MINIMAL - Existing functionality preserved
- **Rollback Difficulty**: LOW - Easy to revert if needed

---

## üèÜ **Architectural Alignment**

### **Current State Assessment**

#### **‚úÖ Well-Implemented**
- **Address Generation**: ‚úÖ Moved to `multiFormatAddresses.tsx`
- **Address Display**: ‚úÖ Centralized in `MultiFormatAddressRenderer`
- **Type Definitions**: ‚úÖ Proper TypeScript interfaces

#### **üîÑ Ready for Improvement**
- **Explorer Links**: üîÑ Candidate for `multiFormatAddresses.tsx`
- **Network Constants**: üîÑ Candidate for `currencies/constants.ts`

### **Architecture Vision**
```
src/components/currencies/
‚îú‚îÄ‚îÄ index.ts                    # Main exports
‚îú‚îÄ‚îÄ constants.ts               # NETWORKS, PROTOCOL_PREFIXES, SupportedTicker
‚îú‚îÄ‚îÄ ext/
‚îÇ   ‚îî‚îÄ‚îÄ multiFormatAddresses.tsx  # Address display + utilities (getExplorerLink)
‚îú‚îÄ‚îÄ [currency].ts              # Individual currency implementations
```

---

## üéØ **Recommendation**

### **PRIMARY RECOMMENDATION: Move `getExplorerLink` Now**

**Move the `getExplorerLink` function from `TemporaryKeyModal.tsx` to `multiFormatAddresses.tsx` as it:**
- Is directly related to address display functionality
- Is a reusable utility function
- Belongs with other currency/address utilities
- Will improve code organization and reusability

### **SECONDARY RECOMMENDATION: Plan Currency Constants Migration**

**Consider creating `src/components/currencies/constants.ts` for:**
- `SupportedTicker` type
- `NETWORKS` array
- `PROTOCOL_PREFIXES` object

**Timeline:** Future sprint - lower priority, higher complexity due to widespread usage.

---

**Analysis Complete** ‚úÖ | **Date:** 2025-10-11 | **Primary Action:** Move `getExplorerLink` to `multiFormatAddresses.tsx`

**Result:** Clear identification of currency logic that should be relocated to maintain proper architectural boundaries. The `getExplorerLink` function is the most obvious and beneficial candidate for immediate migration.
